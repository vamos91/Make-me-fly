var LightFace=new Class({Implements:[Options,Events],options:{width:"auto",height:"auto",draggable:!1,title:"",buttons:[],fadeDelay:400,fadeDuration:400,keys:{esc:function(){this.close()}},content:"<p>Message not specified.</p>",zIndex:9001,pad:100,overlayAll:!1,constrain:!1,resetOnScroll:!0,baseClass:"lightface",errorMessage:"<p>The requested file could not be found.</p>"},initialize:function(a){this.setOptions(a),this.state=!1,this.buttons={},this.resizeOnOpen=!0,this.ie6="undefined"==typeof document.body.style.maxHeight,this.draw()},draw:function(){this.bgoverlay=new Element("div",{"class":"popup-overlay",styles:{"z-index":this.options.zIndex-1,opacity:0},tween:{duration:this.options.fadeDuration,onComplete:function(a){0==this.bgoverlay.getStyle("opacity")&&this.bgoverlay.dispose()}.bind(this)}}).inject(document.body,"bottom"),this.box=new Element("table",{"class":this.options.baseClass,width:this.options.width,styles:{"z-index":this.options.zIndex,opacity:0},tween:{duration:this.options.fadeDuration,onComplete:function(){0==this.box.getStyle("opacity")&&this.destroy()}.bind(this)}}).inject(document.body,"bottom");for(var a=["top","center","bottom"],b=["Left","Center","Right"],c=a.length,d=0;d<c;d++)for(var e=this.box.insertRow(d),f=0;f<c;f++){var g=a[d]+b[f],h=e.insertCell(f);h.className=g,"centerCenter"==g?(this.contentBox=new Element("div",{"class":"lightfaceContent"}),h.appendChild(this.contentBox)):document.id(h).setStyle("opacity",.4)}return this.options.title&&(this.title=new Element("h2",{"class":"lightfaceTitle",html:this.options.title}).inject(this.contentBox),this.options.draggable&&null!=window.Drag&&(this.draggable=!0,new Drag(this.box,{handle:this.title}),this.title.addClass("lightfaceDraggable"))),this.messageBox=new Element("div",{"class":"lightfaceMessageBox",html:this.options.content||"",styles:{height:this.options.height}}).inject(this.contentBox),this.footer=new Element("div",{"class":"lightfaceFooter",styles:{display:"none"}}).inject(this.contentBox),this.buttons=[],this.options.buttons.length&&this.options.buttons.each(function(a){this.addButton(a.title,a.event,a.color)},this),this.focusNode=this.box,this},addButton:function(a,b,c){return this.footer.setStyle("display","block"),this.buttons[a]=new Element("a",{"class":c?c:"",events:{click:(b||this.close).bind(this)}}).grab(new Element("span").set("text",a)).inject(this.footer),this},showButton:function(a){return this.buttons[a]&&this.buttons[a].removeClass("hiddenButton"),this.buttons[a]},hideButton:function(a){return this.buttons[a]&&this.buttons[a].addClass("hiddenButton"),this.buttons[a]},close:function(a){return this.isOpen&&(this.box[a?"setStyles":"tween"]("opacity",0),this.bgoverlay[a?"setStyles":"tween"]("opacity",0),this.fireEvent("close"),this._detachEvents(),this.isOpen=!1),this},open:function(a){return this.isOpen||(this.box[a?"setStyles":"tween"]("opacity",1),this.bgoverlay[a?"setStyles":"tween"]("opacity",.4),this.resizeOnOpen&&this._resize(),this.fireEvent("open"),this._attachEvents(),function(){this._setFocus()}.bind(this).delay(this.options.fadeDuration+10),this.isOpen=!0),this},_setFocus:function(){this.focusNode.setAttribute("tabIndex",0),this.focusNode.focus()},fade:function(a,b){return this._ie6Size(),this.fireEvent("fade"),this},unfade:function(a){return this.fireEvent("unfade"),this},_ie6Size:function(){if(this.ie6){this.contentBox.getSize(),this.options.overlayAll||!this.title?0:this.title.getSize().y}},load:function(a,b){return a&&this.messageBox.set("html",a),b&&this.title&&this.title.set("html",b),this.fireEvent("complete"),this},_attachEvents:function(){return this.keyEvent=function(a){this.options.keys[a.key]&&this.options.keys[a.key].call(this)}.bind(this),this.focusNode.addEvent("keyup",this.keyEvent),this.resizeEvent=this.options.constrain?function(a){this._resize()}.bind(this):function(){this._position()}.bind(this),window.addEvent("resize",this.resizeEvent),this.options.resetOnScroll&&(this.scrollEvent=function(){this._position()}.bind(this),window.addEvent("scroll",this.scrollEvent)),this},_detachEvents:function(){return this.focusNode.removeEvent("keyup",this.keyEvent),window.removeEvent("resize",this.resizeEvent),this.scrollEvent&&window.removeEvent("scroll",this.scrollEvent),this},_position:function(){var a=window.getSize(),b=window.getScroll(),c=this.box.getSize();return this.box.setStyles({left:b.x+(a.x-c.x)/2,top:b.y+(a.y-c.y)/2}),this._ie6Size(),this},_resize:function(){var a=this.options.height;if("auto"==a){var b=window.getSize().y-this.options.pad;this.contentBox.getSize().y>b&&(a=b)}this.messageBox.setStyle("height",a);var c=this;setTimeout(function(){c._position()},0)},toElement:function(){return this.messageBox},getBox:function(){return this.box},destroy:function(){this._detachEvents(),this.buttons.each(function(a){a.removeEvents("click")}),this.box.dispose(),delete this.box}});LightFace.Request=new Class({Extends:LightFace,options:{url:"",request:{url:!1}},initialize:function(a){this.parent(a),this.options.url&&this.load()},load:function(a,b){var c=(Object.append||$extend)({onRequest:function(){this.fade(),this.fireEvent("request")}.bind(this),onSuccess:function(a){this.messageBox.set("html",a),this.fireEvent("success")}.bind(this),onFailure:function(){this.messageBox.set("html",this.options.errorMessage),this.fireEvent("failure")}.bind(this),onComplete:function(){this._resize(),this._ie6Size(),this.messageBox.setStyle("opacity",1),this.unfade(),this.fireEvent("complete")}.bind(this)},this.options.request);return b&&this.title&&this.title.set("html",b),c.url||(c.url=a||this.options.url),new Request(c).send(),this}});var Template={site:"",scrollFx:null,ie6:!1,ie7:!1,_current_popup:null,init:function(a){this.site=a,this.ie6="trident"==Browser.Engine.name&&Browser.Engine.version<5,this.ie7="trident"==Browser.Engine.name&&Browser.Engine.version<6,window.addEvent("domready",function(){var a=new Template.Search($("searchword"));$("menusearch").addEvent("submit",function(){Template.Utilities.trackFormSubmit("SearchX")}),$("menusearch").addEvent("submit",a.submit.bind(a)),Template.activatePlaceholders(),Template.addLinkTracking(),Template.regionSelect()})},back:function(){return history.go(-1),!1},popup_error:function(a){var b='<div class="newsletter-confirm popup-message">'+a;b+='<div class="buttons"><a title="'+lang_theme_close_link+'" class="arrow-button-left close">'+lang_theme_close_link+"</a></div></div>",popup(b,150)},regionSelect:function(){var a=$("site_select");null!=a&&(a.onchange=function(){window.location.href=this.value})},scrollPage:function(a,b,c,d,e){if(0!==b)var b=parseInt(b)||800;"undefined"==typeof c&&(c=0),"undefined"==typeof d&&(d=0),null==this.scrollFx?this.scrollFx=new Fx.Scroll(window,{duration:b,transition:Fx.Transitions.Quad.easeOut,offset:{x:c,y:d}}):this.scrollFx.setOptions({duration:b,offset:{x:c,y:d}}),"object"==typeof a?this.scrollFx.toElement(a):this.scrollFx.scrollTo(0,parseInt(a)),"function"==typeof e&&setTimeout(e,b)},activatePlaceholders:function(){var a=$$("input");if(a.length>0&&"undefined"==typeof a[0].placeholder)for(var b=0;b<a.length;b++)"text"==a[b].getAttribute("type")&&a[b].getAttribute("placeholder")&&a[b].getAttribute("placeholder").length>0&&(""==a[b].value&&(a[b].value=a[b].getAttribute("placeholder")),a[b].addEvent("focus",function(){this.value==this.getAttribute("placeholder")&&(this.value="")}),a[b].addEvent("blur",function(){this.value.length<1&&(this.value=this.getAttribute("placeholder"))}))},addLinkTracking:function(){$$(".social-media a").addEvent("click",function(a){a.preventDefault();var b=this.href;Template.Utilities.trackEvent("Social Media Icon",this.title,b),setTimeout(function(){window.location=b},500)})},popup:function(a,b,c,d,e){null!==this._current_popup&&"function"==typeof this._current_popup.close&&this._current_popup.close();var f={width:300,fadeDuration:400,content:a,overlayAll:!0,baseClass:"popup",redirectUrl:e},g={title:lang_theme_close_link,event:function(a){this._current_popup.close(),"function"==typeof d&&d(a)}.bind(this),color:"close"},h=({title:lang_theme_close_link,event:function(){this._current_popup.close()}.bind(this),color:"close"},{title:lang_theme_proceed_link,event:function(a){var b="A"==a.target.tagName?a.target:a.target.getParent();b.hasClass("disabled")||(this._current_popup.close(),c(a))}.bind(this),color:"confirm"}),i={title:lang_theme_ok,event:function(a){var b="A"==a.target.tagName?a.target:a.target.getParent();b.hasClass("disabled")||(this._current_popup.close(),c(a))}.bind(this),color:"confirm"},j={title:lang_theme_proceed_link,event:function(){this._current_popup.close()}.bind(this),color:"confirm"},k=({title:lang_theme_proceed_link,event:function(){this._current_popup.close()}.bind(this),color:"confirm"},{title:lang_theme_proceed_link,event:function(a){this._current_popup.close(),c(a)}.bind(this),color:"confirm phone"});switch(""==device_type?f.width="600px":f.width="75%",b){case"processing":f.baseClass=f.baseClass+" processing";break;case"klarna":case"agree":f.baseClass=f.baseClass+" agree",f.buttons=[g,h];break;case"stock":f.baseClass=f.baseClass+" agree",f.buttons=[g,i];break;case"close":f.baseClass=f.baseClass+" close",f.buttons=[g];break;case"instagram_report":f.baseClass=f.baseClass+" close instagram_report nomargin",f.buttons=[g];break;case"instagram":f.width="80%",f.baseClass=f.baseClass+" close instagram",f.buttons=[g];break;case"close_timeout":f.baseClass=f.baseClass+" close",f.buttons=[g],setTimeout(function(){this._current_popup.close()}.bind(this),3e3);break;case"csc":f.baseClass=f.baseClass+" close",f.width="cult"==Template.site?409:400,f.buttons=[g];break;case"newsletter":f.baseClass=f.baseClass+" close",f.width="cult"==Template.site?400:500,f.buttons=[g];break;case"confirm":f.baseClass=f.baseClass+" confirm",f.buttons=[j];break;case"phone":f.baseClass=f.baseClass+" confirm phone",f.buttons=[g,k];break;case"phone_invalid":f.baseClass=f.baseClass+" close",f.buttons=[g];break;case"email_invalid":f.baseClass=f.baseClass+" close",f.buttons=[g];break;case"language":f.baseClass=f.baseClass+" close",f.width=675,f.buttons=[g];break;default:setTimeout(function(){this._current_popup.close()}.bind(this),3e3)}this._current_popup=new LightFace(f),"agree"==b&&this._current_popup.addEvent("open",function(){var a=this.getBox().getElement(".confirm");a.addClass("disabled"),$("confirm-terms").addEvent("click",function(){this.checked?a.removeClass("disabled"):a.addClass("disabled")})}),"stock"==b&&(document.onkeydown=function(a){a=a||window.event,27==a.keyCode&&"function"==typeof d&&d()}),"klarna"==b&&this._current_popup.addEvent("open",function(){var a=this.getBox().getElement(".confirm");a.addClass("disabled"),KlarnaHandler._klarnaPopUpListener($("klarna_house_number"),a),KlarnaHandler._klarnaPopUpListener($("klarna_street_address"),a)}),this._current_popup.open()},termsPopup:function(a,b,c){return Template.popup('<input type="checkbox" name="confirm-terms" id="confirm-terms" />'+a,"agree",b,c)},stockPopup:function(a,b){return Template.Utilities.trackEvent("Error Message","Stock",a),Template.popup(a,"stock",b,b)},spinnerControl:function(a,b){var c="loading-spinner"+(b?"-sm":""),d=new Element("span",{"class":c});return a.adopt(d),function(){d.destroy()}}};Template.Search=function(a){this.__input=a},Template.Search.prototype.submit=function(a){a.preventDefault();var b=this.__input.value.trim();""!=b&&(b=b.replace(/[ \/%]/g,"-"),b=decodeURI(encodeURIComponent(b)),window.location=live_site+"search/"+b)},Template.Minibag={dropdown:null,loaded:!1,refresh:!1,mouse_over:!1,init:function(a,b){if($defined("shopping-bag")){var c=$("shopping-bag");this.dropdown=$("minicart_dropdown"),c.hasClass("nodrop")||c.addEvents({mouseenter:function(){this.mouse_over=!0,this.getShoppingBag(),"undefined"!=typeof b&&c.setStyle("background-color",b)}.bind(this),mouseleave:function(){this.mouse_over=!1,this.hide(),"undefined"!=typeof a&&c.setStyle("background-color",a)}.bind(this)})}},getShoppingBag:function(){try{if(this.loaded&&""!=$("minicart_dropdown").innerHTML)this.show();else{var a=function(a){$("minicart_dropdown").innerHTML=a,this.loaded=!0,this.mouse_over&&this.show(),this.updateView()}.bind(this),b={method:"get",onComplete:a,evalScripts:!0};new Ajax(live_site+"index.php?option=com_virtuemart&page=shop.mini_bag&format=raw",b).request()}}catch(c){}},show:function(){this.dropdown.setStyle("display","block")},hide:function(){this.dropdown.setStyle("display","none")},updateView:function(){if(null!=$("mbscroll-container-vertical")){var a=$("minibag_contents").getSize().size.y,b=$("minibag").getSize().size.y,c=a/b;if(c>1){$("mbscroll-container-vertical").innerHTML='<a id="mbscroll-scroll-up" class="control up"></a><div id="mbscroll" class="mbscroll-vert scrollbar-vert"><span id="mbscrollhandle" class="mbscrollhandle-vert handle-vert"><!--  --></span></div><a id="mbscroll-scroll-down" class="control down"></a>';var d=$("mbscroll-scroll-up").getSize().y;$("mbscrollhandle").setStyle("height",(b-2*d)/c),makeScrollbar($("minibag"),$("mbscroll"),$("mbscrollhandle"),!1,!1,0,[$("mbscroll-scroll-up"),$("mbscroll-scroll-down")])}}},reload:function(){this.loaded=!1,this.show(),this.getShoppingBag()},minibag:function(){var a=function(a){$("cart-summary").innerHTML=a,this.init(),this.reload()}.bind(this),b={method:"post",onComplete:a,data:{summary_only:1,only_page:1,page:"shop.basket_short",option:"com_virtuemart"}};new Ajax(live_site+"index2.php",b).request()},removeItem:function(a){var b=function(){this.minibag()}.bind(this),c={method:"post",onComplete:b};new Ajax(live_site+"index.php?option=com_virtuemart&func=cartDelete&format=raw&product_id="+a,c).request()}},Template.Utilities={hashSecure:function(a){return a=decodeURIComponent(a),a.replace(/(<([^>]+)>)/gi,"")},hashToArray:function(){for(var a=location.hash.substr(1).split("&"),b=a.length,c={},d=0;d<b;d++){var e=a[d].split("=");2==e.length&&(c[e[0]]=Template.Utilities.hashSecure(e[1]))}return c},trackEvent:function(){this.gaTrack("_trackEvent",arguments),this.gaUATrack(arguments)},track360Product:function(a){$script.ready(["google_datalayer"],function(){try{DataLayer360.productInteraction(a)}catch(b){}})},setVar:function(){this.gaTrack("_setCustomVar",arguments)},gaTrack:function(a,b){try{for(var c=0,d=[a],e=b.length;c<e;c++)d.push(b[c]);window._gaq=window._gaq||[],window._gaq.push(d)}catch(f){}},gaUATrack:function(a){$script.ready(["google_datalayer"],function(){try{"Error Message"==a[0]&&DataLayer360.errorMessages(a[1],a[2])}catch(b){}})},trackFormSubmit:function(a){$script.ready(["google_datalayer"],function(){try{DataLayer360.formSubmit(a)}catch(b){}})}};var Utilities=function(a){return a.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},a}(Utilities||{});Utilities.notifier=function(){var a=null;this.popup=function(c,d,e){null!==a&&a.close(),d=d||[];var f={width:300,fadeDuration:400,content:c,overlayAll:!0,baseClass:"popup newpopup"};e&&d.push(b()),f.buttons=d.map(function(a){return"undefined"!=typeof a.link&&(a.callback=function(){window.location=a.link}),{title:a.text,event:a.callback,color:a["class"]}}),a=new LightFace(f),a.open(),0==d.length&&setTimeout(function(){a.close()}.bind(this),3e3)};var b=function(){return{text:"Close","class":"button primary close",callback:function(){this.close()}}}};