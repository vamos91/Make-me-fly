function deliveryFormValidation(a){if("object"==typeof AddressValidation&&!AddressValidation.VerifyUkPostcode())return!1;var b=postCodeValidation($("zip").value,$("country").value);if(0==b)return!1;var c=addressFormValidation();if(0==c)return!1;if(null==$("#user_info_id"))if("userAddressAdd"==$("userAddresstype").value||"userAddressUpdate"==$("userAddresstype").value){var d=document.getElementById("address_type_name").value,e="";document.getElementsByName("user_info_id").length>0&&(e=document.getElementsByName("user_info_id")[0].value);var f="index.php?option=com_supergroupadmin&task=checkdeliveryaddress&format=raw&name="+d+"&user_info_id="+e,g=function(b){return 1!=b?(Template.popup(lang_theme_address_label_exists,"close"),!1):void a[0].submit()},h={method:"get",onComplete:g,evalScripts:!0};new Ajax(f,h).request()}else a[0].submit()}function postCodeValidation(a,b){return a=a.toUpperCase()," "!=a&&"GBR"==b&&-1==a.search(postcode_Format)?(Template.popup(lang_theme_invalid_postcode,"close"),!1):void 0}function addressFormValidation(){return""==$("first_name").value||""==$("last_name").value||""==$("address_1").value||""==$("city").value||""==$("zip").value||""==$("country").value?(Template.popup(lang_theme_details_check,"close"),!1):void 0}function billingFormValidation(){if(""==$("vm_gender").value){var a='<div class="newsletter-confirm popup-message">';return a+='<div class="buttons"><a title="'+lang_theme_close_link+'" class="arrow-button-left close"></a></div>'+lang_theme_gender_missing+"</div>",popup(a,"auto"),!1}if("object"==typeof AddressValidation&&!AddressValidation.VerifyUkPostcode())return!1;var b=postCodeValidation($("zip").value,$("country").value);if(0==b)return!1;var c=addressFormValidation();return 0==c?!1:void $$("form.billing")[0].submit()}function handleAddToWishlist(a,b){var c=$(a),d=($("add-to-bag"),$(a).product_id.value);if(d>0){var e=function(){if("waitinglistadd"==c.func.value){var a=lang_theme_wishlist_added;ProductPage.Wishlist.addProduct(d)}else{var a=lang_theme_wishlist_removed;ProductPage.Wishlist.removeProduct(d)}Template.popup(a)},f={method:"post",data:c,onComplete:e,onSuccess:b};new Ajax(c.action,f).request()}else{var g=$(document.body).getElement(".content");new Utilities.ProductPopup(g,$("p").value,{base_url:live_site+"index.php?wl=1",add_to_bag_callback:"add_to_wish_list",template:"select_a_size"})}return!1}var postcode_Format=/^(BFPO[ ]?[0-9]{1,4})$|^([Gg][Ii][Rr] 0[Aa]{2})|((([A-Za-z][0-9]{1,2})|(([A-Za-z][A-Ha-hJ-Yj-y][0-9]{1,2})|(([A-Za-z][0-9][A-Za-z])|([A-Za-z][A-Ha-hJ-Yj-y][0-9]?[A-Za-z])))) [0-9][A-Za-z]{2})$|^([Gg][Ii][Rr]0[Aa]{2})|((([A-Za-z][0-9]{1,2})|(([A-Za-z][A-Ha-hJ-Yj-y][0-9]{1,2})|(([A-Za-z][0-9][A-Za-z])|([A-Za-z][A-Ha-hJ-Yj-y][0-9]?[A-Za-z]))))[0-9][A-Za-z]{2})$/;window.addEvent("domready",function(){$$("form.delivery").addEvent("submit",function(a){new Event(a).stop(),deliveryFormValidation($$("form.delivery"))})});